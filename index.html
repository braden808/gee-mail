<html>

	<head>

      <title>GEEMAIL</title>

    <!-- adding in bootstrap for easier styling -->

    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">

    

		<link href="css/style.css" rel="stylesheet" media="screen">

    

    <script>

    	

      window.onload = function(){



        var getRow = document.getElementsByTagName('tr');



      	for (var i = 0; i < geemails.length; i++) {

  	    	var dateDoc = document.getElementsByClassName("date");

  	    	var subjectDoc = document.getElementsByClassName("subject");

  	    	var senderDoc = document.getElementsByClassName("sender");

  	    	var bodyDoc = document.getElementsByClassName("msgdiv");



      		var date = window.geemails[i].date;

      		var subject = window.geemails[i].subject;

      		var sender = window.geemails[i].sender;

      		var body = window.geemails[i].body;



          var row = document.createElement('tr');

          var main = document.getElementById('content');

          row.className = 'expand';

          main.appendChild(row);

            

         

          //pushes data stored in geemails arrays into the table (rows 2 - 12)

          getRow[i + 2].innerHTML = '<td class="date">'+ date +'</td>' 

            + '<td class="subject">'+ sender +'</td>'

            + '<td class="sender">'+ subject +'</td>' 

            + '<td class="body"><div class = "msgdiv">'+ body +'</div></td>';

          

      	}



       };



        // //SetInterval and runs newMessage function every 10 sec

        

        var incoming = setInterval(newMessage,10000);

        function newMessage(){

            // Pushes New message object into the newMessageArray 

            var i = 11

            geemails.push(getNewMessage());



            var row = document.createElement('tr');

            var main = document.getElementById('content');

            row.className = 'expand';

            main.appendChild(row);

            

            var getRow = document.getElementsByTagName('tr');



            console.log(i);

            // Assigning messages stored in array to variable. These update with interval update. 

            var date = geemails[i-11].date;

            var subject = geemails[i-11].subject;

            var sender = geemails[i-11].sender;

            var body = geemails[i-11].body;



            //pushes data stored in variables into the table starting with the 13th row

            getRow[i].innerHTML = '<td class="date">'+ date +'</td>' 

            + '<td class="subject">'+ sender +'</td>'

            + '<td class="sender">'+ subject +'</td>' 

            + '<td><div class = "msgdiv">'+ body +'</div></td>';

         



            // Get the current email count

            var emailCount = document.getElementsByTagName("tr").length - 2;

            var getCount = document.getElementById('count');

            // console.log(emailCount);

            getCount.innerHTML = '( ' + emailCount + ' Messages )' 



            i++



          }

   

                 // ------------------------------------------------------------------------------

          // var refresh = 

          setInterval(clickMe,1000);      

          function clickMe(){

                    var expandMeVar = document.querySelectorAll("tr.expand");

                    for(var x=0; x<expandMeVar.length; x++)

                    {

                    expandMeVar[x].addEventListener("click", function()

                    

                          {

                          var link = this.querySelector("div");

                            if (link.className == "msgdiv") 

                          {

                            console.log(x);

                            console.log("open");

                            link.className = " ";

                          } 

                            else 

                          {

                            console.log(x);

                            console.log("close");

                            link.className = "msgdiv";

                          }



                        });

                    }

          }

                 // ------------------------------------------------------------------------------

        



    </script>

	</head>

	<body>



      <!-- Title Section using jumbotron from bootstrap-->

      <div class="jumbotron text-center">

          <h1>GEEMAIL</h1>

          <p>Not you regular email!</p> 

      </div>



   		

      <div class="container" id="main">



		

		  		<table id="myTable" class="table table-striped table-hover">

						

            <!-- table head -->

            <thead>

						<tr class="subtr">

							<th>

                <h2>INBOX</h2>

                <span id="count">( 10 Messages )</span>

              </th>

						</tr>

            <tr>

								<th class="dt">Date</th>

								<th class="sndr">Sender</th>

								<th class="sbjct">Subject</th>

								<th class="msg">Message</th>

						</tr>

						</thead>

            <!-- table body -->

						<tbody id="content">



						</tbody>

					</table>

				</div>

			</div>



		</div>

	</body>

	<script src="js/mail-generator.js"></script>



</html>

